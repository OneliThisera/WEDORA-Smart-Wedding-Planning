<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedora Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #6c5ce7; 
            --secondary-color: #a29bfe; 
            --accent-color: #fd79a8; 
            --sidebar-color: #341f97; 
            --light-bg: #f5f6fa;
            --text-color: #333;
            --text-light: #777;
            --shadow: 0 4px 8px rgba(0,0,0,0.1);
            --hover-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-bg);
            color: var(--text-color);
        }

        /* Sidebar */
        .sidebar {
            width: 220px;
            height: 100vh;
            background-color: var(--sidebar-color);
            color: white;
            position: fixed;
            padding: 30px 20px;
            border-radius: 0 15px 15px 0;
            box-shadow: var(--shadow);
            transition: width 0.3s;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar h2 {
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600;
            font-size: 22px;
            letter-spacing: 1px;
        }

        .sidebar a {
            display: flex;
            align-items: center;
            color: white;
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        .sidebar a i {
            margin-right: 12px;
            font-size: 18px;
        }

        .sidebar a:hover {
            background-color: var(--primary-color);
            transform: translateX(5px);
            box-shadow: var(--hover-shadow);
        }

        .sidebar a.active {
            background-color: var(--primary-color);
            box-shadow: var(--shadow);
        }

        /* Main content */
        .main {
            margin-left: 240px;
            padding: 40px 30px;
        }

        .main h1 {
            font-size: 30px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .main p {
            font-size: 17px;
            color: var(--text-light);
            margin-bottom: 30px;
        }

        /* Cards */
        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }

        .card h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .card p {
            color: var(--text-light);
            margin: 0;
        }

        /* Dashboard Stats */
        .stat-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 24px;
        }

        .stat-info h3 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--text-light);
            margin: 0;
        }

        /* Tables */
        .table-container {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: var(--light-bg);
            color: var(--primary-color);
            font-weight: 600;
        }

        tr:hover {
            background-color: #f9f9f9;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 14px;
        }

        .btn-approve {
            background-color: #00b894;
            color: white;
        }

        .btn-reject {
            background-color: #d63031;
            color: white;
        }

        .btn-edit {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-delete {
            background-color: #e17055;
            color: white;
        }

        /* Forms */
        .form-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
        }

        .form-group textarea {
            min-height: 120px;
        }

        .btn-submit {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom: 3px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            width: 500px;
            max-width: 90%;
            box-shadow: var(--hover-shadow);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close {
            font-size: 24px;
            cursor: pointer;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { 
                width: 100%; 
                height: auto; 
                position: relative; 
                border-radius: 0; 
            }
            .main { 
                margin-left: 0; 
                padding: 20px; 
            }
            
            .stat-cards,
            .cards {
                grid-template-columns: 1fr;
            }
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: var(--hover-shadow);
            z-index: 3000;
            opacity: 0;
            transform: translateY(100px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success {
            background-color: #00b894;
        }

        .toast.error {
            background-color: #d63031;
        }
    </style>
</head>
<body>
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Sidebar -->
    <div class="sidebar">
        <h2>Wedora Admin</h2>
        <a href="#" class="active" data-tab="dashboard"><i class="fas fa-home"></i> Dashboard</a>
        <a href="#" data-tab="users"><i class="fas fa-users"></i> User Management</a>
        <a href="#" data-tab="providers"><i class="fas fa-user-check"></i> Provider Approval</a>
        <a href="#" data-tab="complaints"><i class="fas fa-exclamation-circle"></i> Complaints</a>
        <a href="#" data-tab="reports"><i class="fas fa-chart-bar"></i> Reports</a>
        <a href="#" data-tab="categories"><i class="fas fa-layer-group"></i> Categories</a>
        <a href="#" data-tab="locations"><i class="fas fa-map-marker-alt"></i> Locations</a>
        <a href="#" data-tab="news"><i class="fas fa-newspaper"></i> News Feed</a>
        <a href="#" data-tab="backup"><i class="fas fa-database"></i> Data Backup</a>
        <a href="#"><i class="fas fa-cog"></i> Settings</a>
        <a href="#"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>

    <!-- Main Content -->
    <div class="main">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <h1>Admin Dashboard</h1>
            <p>Welcome to the Wedora administration panel. Manage users, service providers, and content from here.</p>

            <!-- Stats Overview -->
            <div class="stat-cards">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-users">0</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #fd79a8;">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-providers">0</h3>
                        <p>Service Providers</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #00b894;">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-appointments">0</h3>
                        <p>Appointments</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #fdcb6e;">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="pending-complaints">0</h3>
                        <p>Pending Complaints</p>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <h2>Quick Actions</h2>
            <div class="cards">
                <div class="card" id="approve-providers-btn">
                    <h3>Approve Providers</h3>
                    <p>Review and approve new service provider registrations</p>
                </div>
                <div class="card" id="manage-users-btn">
                    <h3>Manage Users</h3>
                    <p>View and manage user accounts and permissions</p>
                </div>
                <div class="card" id="generate-reports-btn">
                    <h3>Generate Reports</h3>
                    <p>Create system usage and performance reports</p>
                </div>
                <div class="card" id="backup-data-btn">
                    <h3>Backup Data</h3>
                    <p>Create a backup of the system database</p>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="table-container">
                <h2>Recent Activity</h2>
                <table id="recent-activity">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Action</th>
                            <th>Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <h1>User Management</h1>
            <p>Manage user accounts, permissions, and status.</p>
            
            <div class="table-container">
                <div class="tabs">
                    <div class="tab active" data-user-tab="all-users">All Users</div>
                    <div class="tab" data-user-tab="active-users">Active Users</div>
                    <div class="tab" data-user-tab="blocked-users">Blocked Users</div>
                </div>
                
                <div class="user-tab-content active" id="all-users">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="user-table-body">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Providers Tab -->
        <div id="providers" class="tab-content">
            <h1>Service Provider Approval</h1>
            <p>Review and approve new service provider registrations.</p>
            
            <div class="table-container">
                <h2>Pending Approvals</h2>
                <table id="pending-providers-table">
                    <thead>
                        <tr>
                            <th>Company Name</th>
                            <th>Owner</th>
                            <th>Service Type</th>
                            <th>Location</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="table-container">
                <h2>Approved Providers</h2>
                <table id="approved-providers-table">
                    <thead>
                        <tr>
                            <th>Company Name</th>
                            <th>Owner</th>
                            <th>Service Type</th>
                            <th>Location</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Complaints Tab -->
        <div id="complaints" class="tab-content">
            <h1>Complaint Management</h1>
            <p>Handle user complaints and issues.</p>
            
            <div class="table-container">
                <div class="tabs">
                    <div class="tab active" data-complaint-tab="all-complaints">All Complaints</div>
                    <div class="tab" data-complaint-tab="pending-complaints">Pending</div>
                    <div class="tab" data-complaint-tab="resolved-complaints">Resolved</div>
                </div>
                
                <div class="complaint-tab-content active" id="all-complaints">
                    <table id="complaints-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Issue</th>
                                <th>Priority</th>
                                <th>Status</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <h1>Reports</h1>
            <p>Generate and view system reports.</p>
            
            <div class="form-container">
                <h2>Generate Report</h2>
                <form id="report-form">
                    <div class="form-group">
                        <label for="report-type">Report Type</label>
                        <select id="report-type" required>
                            <option value="user_activity">User Activity</option>
                            <option value="service_usage">Service Usage</option>
                            <option value="revenue">Revenue</option>
                            <option value="overview">System Overview</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="report-period">Time Period</label>
                        <select id="report-period" required>
                            <option value="7">Last 7 Days</option>
                            <option value="30" selected>Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                            <option value="365">Last Year</option>
                        </select>
                    </div>
                    <button type="submit" class="btn-submit">Generate Report</button>
                </form>
            </div>
            
            <div class="table-container">
                <h2>Report Results</h2>
                <div id="report-results">
                    <p>Select a report type and generate to view results.</p>
                </div>
            </div>
        </div>

        <!-- Categories Tab -->
        <div id="categories" class="tab-content">
            <h1>Category Management</h1>
            <p>Manage service categories.</p>
            
            <div class="form-container">
                <h2>Add New Category</h2>
                <form id="category-form">
                    <div class="form-group">
                        <label for="category-name">Category Name</label>
                        <input type="text" id="category-name" required>
                    </div>
                    <button type="submit" class="btn-submit">Add Category</button>
                </form>
            </div>
            
            <div class="table-container">
                <h2>Existing Categories</h2>
                <table id="categories-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Category Name</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Locations Tab -->
        <div id="locations" class="tab-content">
            <h1>Location Management</h1>
            <p>Manage service locations.</p>
            
            <div class="form-container">
                <h2>Add New Location</h2>
                <form id="location-form">
                    <div class="form-group">
                        <label for="location-name">Location Name</label>
                        <input type="text" id="location-name" required>
                    </div>
                    <div class="form-group">
                        <label for="location-latitude">Latitude</label>
                        <input type="text" id="location-latitude" required>
                    </div>
                    <div class="form-group">
                        <label for="location-longitude">Longitude</label>
                        <input type="text" id="location-longitude" required>
                    </div>
                    <button type="submit" class="btn-submit">Add Location</button>
                </form>
            </div>
            
            <div class="table-container">
                <h2>Existing Locations</h2>
                <table id="locations-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Latitude</th>
                            <th>Longitude</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- News Feed Tab -->
        <div id="news" class="tab-content">
            <h1>News Feed Management</h1>
            <p>Manage news and announcements.</p>
            
            <div class="form-container">
                <h2>Add News Item</h2>
                <form id="news-form">
                    <div class="form-group">
                        <label for="news-title">Title</label>
                        <input type="text" id="news-title" required>
                    </div>
                    <div class="form-group">
                        <label for="news-content">Content</label>
                        <textarea id="news-content" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="news-image">Image URL (optional)</label>
                        <input type="text" id="news-image">
                    </div>
                    <div class="form-group">
                        <label for="news-published">
                            <input type="checkbox" id="news-published"> Publish Immediately
                        </label>
                    </div>
                    <button type="submit" class="btn-submit">Add News Item</button>
                </form>
            </div>
            
            <div class="table-container">
                <h2>News Items</h2>
                <table id="news-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Title</th>
                            <th>Status</th>
                            <th>Created At</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Data Backup Tab -->
        <div id="backup" class="tab-content">
            <h1>Data Backup</h1>
            <p>Manage database backups.</p>
            
            <div class="cards">
                <div class="card" id="create-backup-btn">
                    <h3>Create Backup</h3>
                    <p>Create a new database backup</p>
                </div>
                <div class="card" id="restore-backup-btn">
                    <h3>Restore Backup</h3>
                    <p>Restore from a previous backup</p>
                </div>
            </div>
            
            <div class="table-container">
                <h2>Backup History</h2>
                <table id="backup-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Filename</th>
                            <th>Size</th>
                            <th>Created At</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit User</h2>
                <span class="close">&times;</span>
            </div>
            <form id="user-form">
                <input type="hidden" id="user-id">
                <div class="form-group">
                    <label for="user-name">Name</label>
                    <input type="text" id="user-name" required>
                </div>
                <div class="form-group">
                    <label for="user-email">Email</label>
                    <input type="email" id="user-email" required>
                </div>
                <div class="form-group">
                    <label for="user-role">Role</label>
                    <select id="user-role">
                        <option value="customer">Customer</option>
                        <option value="provider">Provider</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="user-status">Status</label>
                    <select id="user-status">
                        <option value="active">Active</option>
                        <option value="blocked">Blocked</option>
                        <option value="pending">Pending</option>
                    </select>
                </div>
                <button type="submit" class="btn-submit">Save Changes</button>
            </form>
        </div>
    </div>

    <div id="complaint-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Complaint Details</h2>
                <span class="close">&times;</span>
            </div>
            <div id="complaint-details">
                <!-- Complaint details will be populated here -->
            </div>
            <div class="form-group">
                <label for="complaint-status">Update Status</label>
                <select id="complaint-status">
                    <option value="pending">Pending</option>
                    <option value="in_progress">In Progress</option>
                    <option value="resolved">Resolved</option>
                </select>
            </div>
            <button class="btn-submit" onclick="updateComplaintStatus()">Update Status</button>
        </div>
    </div>

    <script>
    // Global variables
    let currentTab = 'dashboard';
    let users = [];
    let providers = [];
    let complaints = [];
    let categories = [];
    let locations = [];
    let newsItems = [];
    let backups = [];
    let currentComplaintId = null;

    // Mock data for demonstration
    const mockData = {
        dashboard: {
            total_users: 1245,
            total_providers: 367,
            today_appointments: 42,
            pending_complaints: 18
        },
        users: [
            { id: 1, name: 'John Doe', email: 'john@example.com', role: 'customer', status: 'active' },
            { id: 2, name: 'Jane Smith', email: 'jane@example.com', role: 'provider', status: 'active' },
            { id: 3, name: 'Bob Johnson', email: 'bob@example.com', role: 'customer', status: 'blocked' },
            { id: 4, name: 'Alice Brown', email: 'alice@example.com', role: 'admin', status: 'active' },
            { id: 5, name: 'Charlie Wilson', email: 'charlie@example.com', role: 'customer', status: 'pending' }
        ],
        providers: [
            { id: 1, company_name: 'Quality Plumbing', owner_name: 'Mike Johnson', service_type: 'Plumbing', location: 'New York', status: 'pending' },
            { id: 2, company_name: 'Fast Electric', owner_name: 'Sarah Williams', service_type: 'Electrical', location: 'Chicago', status: 'pending' },
            { id: 3, company_name: 'Clean House', owner_name: 'Emma Davis', service_type: 'Cleaning', location: 'Los Angeles', status: 'approved' },
            { id: 4, company_name: 'Garden Care', owner_name: 'Tom Wilson', service_type: 'Gardening', location: 'Miami', status: 'approved' }
        ],
        complaints: [
            { id: 1, user_name: 'John Doe', issue: 'Late arrival', description: 'The service provider arrived 2 hours late', priority: 'Medium', status: 'pending', created_at: '2023-05-15' },
            { id: 2, user_name: 'Jane Smith', issue: 'Poor service quality', description: 'The work was not completed properly', priority: 'High', status: 'in_progress', created_at: '2023-05-17' },
            { id: 3, user_name: 'Bob Johnson', issue: 'Overcharged', description: 'I was charged more than the quoted price', priority: 'High', status: 'resolved', created_at: '2023-05-10' }
        ],
        categories: [
            { id: 1, name: 'Plumbing' },
            { id: 2, name: 'Electrical' },
            { id: 3, name: 'Cleaning' },
            { id: 4, name: 'Gardening' }
        ],
        locations: [
            { id: 1, name: 'New York', latitude: '40.7128', longitude: '-74.0060', status: 'active' },
            { id: 2, name: 'Chicago', latitude: '41.8781', longitude: '-87.6298', status: 'active' },
            { id: 3, name: 'Los Angeles', latitude: '34.0522', longitude: '-118.2437', status: 'active' }
        ],
        news: [
            { id: 1, title: 'New Features Released', content: 'We have released new features for better user experience', status: 'published', created_at: '2023-05-01' },
            { id: 2, title: 'Maintenance Notice', content: 'Scheduled maintenance on Sunday', status: 'draft', created_at: '2023-05-05' }
        ],
        backups: [
            { id: 1, filename: 'backup_20230501.sql', size: '2.4 MB', created_at: '2023-05-01' },
            { id: 2, filename: 'backup_20230515.sql', size: '2.6 MB', created_at: '2023-05-15' }
        ]
    };

    // Initialize the dashboard
    document.addEventListener('DOMContentLoaded', function() {
        // Load initial data
        loadDashboardData();
        loadUsers();
        loadProviders();
        loadComplaints();
        loadCategories();
        loadLocations();
        loadNews();
        loadBackups();

        // Set up tab navigation
        setupTabNavigation();

        // Set up quick action buttons
        document.getElementById('approve-providers-btn').addEventListener('click', function() {
            switchTab('providers');
        });

        document.getElementById('manage-users-btn').addEventListener('click', function() {
            switchTab('users');
        });

        document.getElementById('generate-reports-btn').addEventListener('click', function() {
            switchTab('reports');
        });

        document.getElementById('backup-data-btn').addEventListener('click', function() {
            switchTab('backup');
        });

        document.getElementById('create-backup-btn').addEventListener('click', function() {
            createBackup();
        });

        // Set up modal close buttons
        document.querySelectorAll('.close').forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });

        // Set up form submissions
        document.getElementById('user-form').addEventListener('submit', function(e) {
            e.preventDefault();
            saveUser();
        });

        document.getElementById('category-form').addEventListener('submit', function(e) {
            e.preventDefault();
            addCategory();
        });

        document.getElementById('location-form').addEventListener('submit', function(e) {
            e.preventDefault();
            addLocation();
        });

        document.getElementById('news-form').addEventListener('submit', function(e) {
            e.preventDefault();
            addNewsItem();
        });

        document.getElementById('report-form').addEventListener('submit', function(e) {
            e.preventDefault();
            generateReport();
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // Set up user tabs
        document.querySelectorAll('[data-user-tab]').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.getAttribute('data-user-tab');
                switchUserTab(tabName);
            });
        });

        // Set up complaint tabs
        document.querySelectorAll('[data-complaint-tab]').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.getAttribute('data-complaint-tab');
                switchComplaintTab(tabName);
            });
        });
    });

    // Show toast notification
    function showToast(message, type = 'success') {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.className = `toast ${type} show`;
        
        setTimeout(() => {
            toast.className = 'toast';
        }, 3000);
    }

    // Set up tab navigation
    function setupTabNavigation() {
        const tabLinks = document.querySelectorAll('.sidebar a[data-tab]');
        
        tabLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const tabName = this.getAttribute('data-tab');
                switchTab(tabName);
            });
        });
    }

    // Switch between tabs
    function switchTab(tabName) {
        // Update active tab in sidebar
        document.querySelectorAll('.sidebar a').forEach(link => {
            link.classList.remove('active');
        });
        document.querySelector(`.sidebar a[data-tab="${tabName}"]`).classList.add('active');
        
        // Update active tab content
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        document.getElementById(tabName).classList.add('active');
        
        currentTab = tabName;
        
        // Reload data for the current tab
        if (tabName === 'users') loadUsers();
        if (tabName === 'providers') loadProviders();
        if (tabName === 'complaints') loadComplaints();
        if (tabName === 'categories') loadCategories();
        if (tabName === 'locations') loadLocations();
        if (tabName === 'news') loadNews();
        if (tabName === 'backup') loadBackups();
    }

    // Switch user tabs
    function switchUserTab(tabName) {
        document.querySelectorAll('[data-user-tab]').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelector(`[data-user-tab="${tabName}"]`).classList.add('active');
        
        document.querySelectorAll('.user-tab-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(tabName).classList.add('active');
        
        renderUsersTable(tabName);
    }

    // Switch complaint tabs
    function switchComplaintTab(tabName) {
        document.querySelectorAll('[data-complaint-tab]').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelector(`[data-complaint-tab="${tabName}"]`).classList.add('active');
        
        document.querySelectorAll('.complaint-tab-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(tabName).classList.add('active');
        
        renderComplaintsTable(tabName);
    }

    // Load dashboard data
    async function loadDashboardData() {
        // Use mock data instead of API call
        const data = mockData.dashboard;
        
        document.getElementById('total-users').textContent = data.total_users || 0;
        document.getElementById('total-providers').textContent = data.total_providers || 0;
        document.getElementById('total-appointments').textContent = data.today_appointments || 0;
        document.getElementById('pending-complaints').textContent = data.pending_complaints || 0;
        
        // Add recent activity
        const activityTable = document.querySelector('#recent-activity tbody');
        activityTable.innerHTML = '';
        
        const sampleActivity = [
            { user: 'John Doe', action: 'Logged in', time: '2 hours ago' },
            { user: 'Jane Smith', action: 'Updated profile', time: '5 hours ago' },
            { user: 'Admin', action: 'Added new category', time: 'Yesterday' },
            { user: 'Bob Johnson', action: 'Created appointment', time: '2 days ago' }
        ];
        
        sampleActivity.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item.user}</td>
                <td>${item.action}</td>
                <td>${item.time}</td>
            `;
            activityTable.appendChild(row);
        });
    }

    // Load users
    async function loadUsers() {
        // Use mock data instead of API call
        users = mockData.users;
        renderUsersTable('all-users');
    }

    // Render users table
    function renderUsersTable(filter = 'all-users') {
        const tableBody = document.getElementById('user-table-body');
        tableBody.innerHTML = '';
        
        let filteredUsers = users;
        
        if (filter === 'active-users') {
            filteredUsers = users.filter(user => user.status === 'active');
        } else if (filter === 'blocked-users') {
            filteredUsers = users.filter(user => user.status === 'blocked');
        }
        
        filteredUsers.forEach(user => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${user.id}</td>
                <td>${user.name}</td>
                <td>${user.email}</td>
                <td>${user.role}</td>
                <td>${user.status}</td>
                <td>
                    <button class="action-btn btn-edit" onclick="editUser(${user.id})">Edit</button>
                    <button class="action-btn btn-delete" onclick="deleteUser(${user.id})">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Edit user
    function editUser(userId) {
        const user = users.find(u => u.id === userId);
        
        if (user) {
            document.getElementById('user-id').value = user.id;
            document.getElementById('user-name').value = user.name;
            document.getElementById('user-email').value = user.email;
            document.getElementById('user-role').value = user.role;
            document.getElementById('user-status').value = user.status;
            
            document.getElementById('user-modal').style.display = 'flex';
        }
    }

    // Save user
    async function saveUser() {
        const userId = document.getElementById('user-id').value;
        const name = document.getElementById('user-name').value;
        const email = document.getElementById('user-email').value;
        const role = document.getElementById('user-role').value;
        const status = document.getElementById('user-status').value;
        
        // Update user in mock data
        const userIndex = users.findIndex(u => u.id == userId);
        if (userIndex !== -1) {
            users[userIndex] = { 
                id: parseInt(userId), 
                name, 
                email, 
                role, 
                status 
            };
            showToast('User updated successfully');
            document.getElementById('user-modal').style.display = 'none';
            loadUsers();
        } else {
            showToast('Failed to update user', 'error');
        }
    }

    // Delete user
    async function deleteUser(userId) {
        if (confirm('Are you sure you want to delete this user?')) {
            // Remove user from mock data
            users = users.filter(user => user.id !== userId);
            showToast('User deleted successfully');
            loadUsers();
        }
    }

    // Load providers
    async function loadProviders() {
        // Use mock data instead of API call
        providers = mockData.providers;
        renderProvidersTable();
    }

    // Render providers table
    function renderProvidersTable() {
        const pendingTable = document.querySelector('#pending-providers-table tbody');
        const approvedTable = document.querySelector('#approved-providers-table tbody');
        
        pendingTable.innerHTML = '';
        approvedTable.innerHTML = '';
        
        providers.forEach(provider => {
            const row = document.createElement('tr');
            
            if (provider.status === 'pending') {
                row.innerHTML = `
                    <td>${provider.company_name}</td>
                    <td>${provider.owner_name}</td>
                    <td>${provider.service_type}</td>
                    <td>${provider.location}</td>
                    <td>
                        <button class="action-btn btn-approve" onclick="approveProvider(${provider.id})">Approve</button>
                        <button class="action-btn btn-reject" onclick="rejectProvider(${provider.id})">Reject</button>
                    </td>
                `;
                pendingTable.appendChild(row);
            } else {
                row.innerHTML = `
                    <td>${provider.company_name}</td>
                    <td>${provider.owner_name}</td>
                    <td>${provider.service_type}</td>
                    <td>${provider.location}</td>
                    <td>${provider.status}</td>
                    <td>
                        <button class="action-btn btn-edit" onclick="editProvider(${provider.id})">Edit</button>
                        <button class="action-btn btn-delete" onclick="deleteProvider(${provider.id})">Delete</button>
                    </td>
                `;
                approvedTable.appendChild(row);
            }
        });
    }

    // Approve provider
    async function approveProvider(providerId) {
        // Update provider status in mock data
        const providerIndex = providers.findIndex(p => p.id === providerId);
        if (providerIndex !== -1) {
            providers[providerIndex].status = 'approved';
            showToast('Provider approved successfully');
            loadProviders();
        } else {
            showToast('Failed to approve provider', 'error');
        }
    }

    // Reject provider
    async function rejectProvider(providerId) {
        // Update provider status in mock data
        const providerIndex = providers.findIndex(p => p.id === providerId);
        if (providerIndex !== -1) {
            providers[providerIndex].status = 'rejected';
            showToast('Provider rejected successfully');
            loadProviders();
        } else {
            showToast('Failed to reject provider', 'error');
        }
    }

    // Load complaints
    async function loadComplaints() {
        // Use mock data instead of API call
        complaints = mockData.complaints;
        renderComplaintsTable('all-complaints');
    }

    // Render complaints table
    function renderComplaintsTable(filter = 'all-complaints') {
        const tableBody = document.querySelector('#complaints-table tbody');
        tableBody.innerHTML = '';
        
        let filteredComplaints = complaints;
        
        if (filter === 'pending-complaints') {
            filteredComplaints = complaints.filter(complaint => complaint.status === 'pending');
        } else if (filter === 'resolved-complaints') {
            filteredComplaints = complaints.filter(complaint => complaint.status === 'resolved');
        }
        
        filteredComplaints.forEach(complaint => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${complaint.id}</td>
                <td>${complaint.user_name}</td>
                <td>${complaint.issue}</td>
                <td>${complaint.priority}</td>
                <td>${complaint.status}</td>
                <td>${complaint.created_at}</td>
                <td>
                    <button class="action-btn btn-edit" onclick="viewComplaint(${complaint.id})">View</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // View complaint details
    function viewComplaint(complaintId) {
        currentComplaintId = complaintId;
        const complaint = complaints.find(c => c.id === complaintId);
        
        if (complaint) {
            document.getElementById('complaint-details').innerHTML = `
                <p><strong>User:</strong> ${complaint.user_name}</p>
                <p><strong>Issue:</strong> ${complaint.issue}</p>
                <p><strong>Description:</strong> ${complaint.description}</p>
                <p><strong>Priority:</strong> ${complaint.priority}</p>
                <p><strong>Status:</strong> ${complaint.status}</p>
                <p><strong>Created At:</strong> ${complaint.created_at}</p>
            `;
            
            document.getElementById('complaint-status').value = complaint.status;
            document.getElementById('complaint-modal').style.display = 'flex';
        }
    }

    // Update complaint status
    async function updateComplaintStatus() {
        const status = document.getElementById('complaint-status').value;
        
        // Update complaint status in mock data
        const complaintIndex = complaints.findIndex(c => c.id === currentComplaintId);
        if (complaintIndex !== -1) {
            complaints[complaintIndex].status = status;
            showToast('Complaint status updated successfully');
            document.getElementById('complaint-modal').style.display = 'none';
            loadComplaints();
        } else {
            showToast('Failed to update complaint status', 'error');
        }
    }

    // Load categories
    async function loadCategories() {
        // Use mock data instead of API call
        categories = mockData.categories;
        renderCategoriesTable();
    }

    // Render categories table
    function renderCategoriesTable() {
        const tableBody = document.querySelector('#categories-table tbody');
        tableBody.innerHTML = '';
        
        categories.forEach(category => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${category.id}</td>
                <td>${category.name}</td>
                <td>
                    <button class="action-btn btn-edit" onclick="editCategory(${category.id})">Edit</button>
                    <button class="action-btn btn-delete" onclick="deleteCategory(${category.id})">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Add category
    async function addCategory() {
        const name = document.getElementById('category-name').value;
        const newId = categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1;
        
        // Add to mock data
        categories.push({ id: newId, name });
        showToast('Category added successfully');
        document.getElementById('category-form').reset();
        loadCategories();
    }

    // Load locations
    async function loadLocations() {
        // Use mock data instead of API call
        locations = mockData.locations;
        renderLocationsTable();
    }

    // Render locations table
    function renderLocationsTable() {
        const tableBody = document.querySelector('#locations-table tbody');
        tableBody.innerHTML = '';
        
        locations.forEach(location => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${location.id}</td>
                <td>${location.name}</td>
                <td>${location.latitude}</td>
                <td>${location.longitude}</td>
                <td>${location.status}</td>
                <td>
                    <button class="action-btn btn-edit" onclick="editLocation(${location.id})">Edit</button>
                    <button class="action-btn btn-delete" onclick="deleteLocation(${location.id})">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Add location
    async function addLocation() {
        const name = document.getElementById('location-name').value;
        const latitude = document.getElementById('location-latitude').value;
        const longitude = document.getElementById('location-longitude').value;
        const newId = locations.length > 0 ? Math.max(...locations.map(l => l.id)) + 1 : 1;
        
        // Add to mock data
        locations.push({ 
            id: newId, 
            name, 
            latitude, 
            longitude, 
            status: 'active' 
        });
        showToast('Location added successfully');
        document.getElementById('location-form').reset();
        loadLocations();
    }

    // Load news items
    async function loadNews() {
        // Use mock data instead of API call
        newsItems = mockData.news;
        renderNewsTable();
    }

    // Render news table
    function renderNewsTable() {
        const tableBody = document.querySelector('#news-table tbody');
        tableBody.innerHTML = '';
        
        newsItems.forEach(news => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${news.id}</td>
                <td>${news.title}</td>
                <td>${news.status}</td>
                <td>${news.created_at}</td>
                <td>
                    <button class="action-btn btn-edit" onclick="editNews(${news.id})">Edit</button>
                    <button class="action-btn btn-delete" onclick="deleteNews(${news.id})">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Add news item
    async function addNewsItem() {
        const title = document.getElementById('news-title').value;
        const content = document.getElementById('news-content').value;
        const image = document.getElementById('news-image').value;
        const published = document.getElementById('news-published').checked;
        const newId = newsItems.length > 0 ? Math.max(...newsItems.map(n => n.id)) + 1 : 1;
        
        // Add to mock data
        newsItems.push({ 
            id: newId, 
            title, 
            content, 
            status: published ? 'published' : 'draft', 
            created_at: new Date().toISOString().split('T')[0] 
        });
        showToast('News item added successfully');
        document.getElementById('news-form').reset();
        loadNews();
    }

    // Load backups
    async function loadBackups() {
        // Use mock data instead of API call
        backups = mockData.backups;
        renderBackupsTable();
    }

    // Render backups table
    function renderBackupsTable() {
        const tableBody = document.querySelector('#backup-table tbody');
        tableBody.innerHTML = '';
        
        backups.forEach(backup => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${backup.id}</td>
                <td>${backup.filename}</td>
                <td>${backup.size}</td>
                <td>${backup.created_at}</td>
                <td>
                    <button class="action-btn btn-edit" onclick="downloadBackup(${backup.id})">Download</button>
                    <button class="action-btn btn-delete" onclick="deleteBackup(${backup.id})">Delete</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Create backup
    async function createBackup() {
        const newId = backups.length > 0 ? Math.max(...backups.map(b => b.id)) + 1 : 1;
        const now = new Date();
        const dateStr = now.toISOString().split('T')[0].replace(/-/g, '');
        
        // Add to mock data
        backups.push({ 
            id: newId, 
            filename: `backup_${dateStr}.sql`, 
            size: '2.8 MB', 
            created_at: now.toISOString().split('T')[0] 
        });
        showToast('Backup created successfully');
        loadBackups();
    }

    // Generate report
    async function generateReport() {
        const reportType = document.getElementById('report-type').value;
        const period = document.getElementById('report-period').value;
        
        // Create mock report data
        const reportData = {
            user_activity: { total_logins: 1245, new_registrations: 42, active_users: 867 },
            service_usage: { total_services: 567, most_popular: 'Plumbing', average_rating: 4.5 },
            revenue: { total_revenue: 12500, revenue_trend: 'up', top_services: ['Plumbing', 'Electrical'] },
            overview: { ...mockData.dashboard, system_uptime: '99.9%' }
        };
        
        const resultsDiv = document.getElementById('report-results');
        resultsDiv.innerHTML = `
            <h3>${reportType.replace('_', ' ').toUpperCase()} Report</h3>
            <p>Generated for the last ${period} days</p>
            <pre>${JSON.stringify(reportData[reportType], null, 2)}</pre>
        `;
    }

    // These functions would need to be implemented based on your backend
    function editProvider(id) { 
        const provider = providers.find(p => p.id === id);
        if (provider) {
            alert(`Edit provider: ${provider.company_name}`);
        }
    }
    
    function deleteProvider(id) { 
        if (confirm('Are you sure you want to delete this provider?')) {
            providers = providers.filter(provider => provider.id !== id);
            showToast('Provider deleted successfully');
            loadProviders();
        }
    }
    
    function editCategory(id) { 
        const category = categories.find(c => c.id === id);
        if (category) {
            const newName = prompt('Enter new category name:', category.name);
            if (newName) {
                category.name = newName;
                showToast('Category updated successfully');
                loadCategories();
            }
        }
    }
    
    function deleteCategory(id) { 
        if (confirm('Are you sure you want to delete this category?')) {
            categories = categories.filter(category => category.id !== id);
            showToast('Category deleted successfully');
            loadCategories();
        }
    }
    
    function editLocation(id) { 
        const location = locations.find(l => l.id === id);
        if (location) {
            alert(`Edit location: ${location.name}`);
        }
    }
    
    function deleteLocation(id) { 
        if (confirm('Are you sure you want to delete this location?')) {
            locations = locations.filter(location => location.id !== id);
            showToast('Location deleted successfully');
            loadLocations();
        }
    }
    
    function editNews(id) { 
        const news = newsItems.find(n => n.id === id);
        if (news) {
            alert(`Edit news: ${news.title}`);
        }
    }
    
    function deleteNews(id) { 
        if (confirm('Are you sure you want to delete this news item?')) {
            newsItems = newsItems.filter(news => news.id !== id);
            showToast('News item deleted successfully');
            loadNews();
        }
    }
    
    function downloadBackup(id) { 
        const backup = backups.find(b => b.id === id);
        if (backup) {
            alert(`Download backup: ${backup.filename}`);
        }
    }
    
    function deleteBackup(id) { 
        if (confirm('Are you sure you want to delete this backup?')) {
            backups = backups.filter(backup => backup.id !== id);
            showToast('Backup deleted successfully');
            loadBackups();
        }
    }
    </script>
</body>
</html>